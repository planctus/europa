<?xml version="1.0" encoding="UTF-8" ?>

<project name="Dt specific tagets" default="install-base">

    <!-- Phing target to install standard profile -->
    <target name="install-base">
        <!-- Remove old settings file -->
        <phingcall target="unprotect-folder">
            <property name="folder.to.unprotect" value="${platform.build.settings.dir}" />
        </phingcall>
        <echo msg="Deleting settings file" />
        <phingcall target="delete-folder">
            <property name="folder.to.delete" value="${platform.build.dir}/sites/default/settings.php" />
        </phingcall>
        <!--
            Ensure the settings folder is writable so the installer can create
            the settings.php file.
         -->
        <chmod mode="0755" failonerror="false" verbose="false" quiet="true">
            <fileset dir="${platform.build.settings.dir}" />
        </chmod>
        <!-- Install minimal profile -->
        <exec command='php src/Phing/generateSettings.php "${drupal.db.url}" "${platform.build.dir}"' escape="false"/>
    </target>

    <!-- Chaining target to rebuild dev environment -->
    <target
        name="rebuild-dev-db"
        description="Rebuild dev environment with database"
        depends="build-dev, install-base, restore-ac-db"
    />

</project>
