(function(win,doc){win.isIE=(function(){var ie=(/*@cc_on!@*/ 0);if(ie){var v=3,div=doc.createElement("div"),all=div.getElementsByTagName("i");while(div.innerHTML="<!--[if gt IE " +(++v)+ "]><i></i><![endif]-->",all[0]);return v > 4 ? v:(/*@cc_on!@*/ false);}return ie;}());if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var l=this.length >>> 0,f=Number(arguments[1])|| 0;f=(f < 0)? Math.ceil(f):Math.floor(f);if(f < 0){f +=l;}for(;f < l;f++){if(f in this && this[f]===elt){return f;}}return -1;};}if(!window.console){window.console={"log":function(){}};}win.$wt={_version:"1.0.0",_path:"//europa.eu/webtools",_js:"/js.php?widgets=",_css:"/css.php?widgets=",_jsonp:"/jsonp.php?url=",extend:function(o){for(var i in o){$wt[i]=o[i];}},addEvent:function(o,e,f){if(e==="load" && doc.readyState==="complete"){f();return;}if(o.addEventListener){o.addEventListener(e,f,false);}else if(o.attachEvent){o.attachEvent("on" + e,f);}},getExtension:function(s){if(!s){return;}s=(s.toLowerCase()).split("#")[0].split("?")[0];s=(/[.]/.exec(s))? /[^.]+$/.exec(s):undefined;return s + "";},before:function(newElm,targetElm){var p,t=targetElm,n=newElm;if(t){p=t.parentNode;if(p){p.insertBefore(n,t);}}},widgets:[],getDocLang:function(){if(doc.lang){return doc.lang;}var l="en",a=doc.getElementsByTagName("html"),n=doc.querySelectorAll("meta[http-equiv='Content-Language']"),g=(win.location + "").replace(/(.*)(_|-|::|=|\/)([a-zA-Z]{2})(\.|&|#|$|\?|\/)(.*)/ig,"$3");if(a[0] && a[0].lang){l=(a[0].lang).split("_")[0].split("-")[0];}else if(n[0]){l=n[0].content;}else if(g.length===2){l=g.toLowerCase();}doc.lang=l;return l;},include:function(srcFile,callback,ext,forceReload){if(!$wt.isLoad){$wt.isLoad=[];}var i,s=srcFile,f=callback,t=($wt.isLoad[s])? true:false,j,e,h,r;if(t===false || forceReload){e=(ext)? ext:$wt.getExtension(s);if(e==="js"){i=doc.createElement("script");i.setAttribute("type","text/javascript");i.setAttribute("src",s);h=doc.getElementsByTagName("body")[0];}else if(e==="css"){i=doc.createElement("link");i.setAttribute("type","text/css");i.setAttribute("rel","stylesheet");i.setAttribute("media","all");i.setAttribute("href",s);h=doc.getElementsByTagName("head")[0];}if(typeof f==="function"){if(isIE){i.onreadystatechange=function(){j=this.readyState;if(j==="loaded" || j==="complete"){f(i);}};}else{i.onload=f;}i.onerror=f;}if(h){h.appendChild(i);}$wt.isLoad[s]=i;}else if(typeof f==="function"){f();}},load:function(srcFiles,callback){var toLoad=[];if($wt.isArray(srcFiles)){toLoad=srcFiles;}else{toLoad.push(srcFiles);}$wt.include(toLoad[0],function(){toLoad.shift();if(toLoad.length===0){if(typeof callback==="function"){callback();}}else{$wt.load(toLoad,callback);}},"js");},getUrlParams:function(s){var p={};(s || window.location.search).replace(/[?&]+([^=&]+)=([^&]*)/gi,function(str,key,value){value=decodeURIComponent(value);if(key.indexOf("[")!==-1){var k=key.replace("[]","");if(!p[k]){p[k]=[];}p[k].push(value);}else{p[key]=value;}});return p;},_order:[],_store:[],_inProgress:false,_queue:function(c){if(c==="next"){$wt._inProgress=false;var c=win.wtCurrentProcess;c.className="wtWidgets wtEnd " +(c.className).split(" ")[0];}if(!$wt._inProgress){clearTimeout($wt.timeOut);$wt.timeOut=setTimeout($wt._process,0);}},_isVisible:function(e){var c=e.getBoundingClientRect();return(c.top >=0 && c.top <=(window.innerHeight || document.documentElement.clientHeight));},_collect:function(){if(!doc.querySelectorAll){return;}var n=doc.querySelectorAll("script[type='application/json']"),c=[];if(n.length){for(var x=0,l=n.length;x < l;x++){var j={};try{j=JSON.parse(n[x].innerHTML);}catch(e){}if(j["service"]){var v=(j["version"])?((j["version"])+ "/"):"",a=(j["lang"])?("-" + j["lang"]):"",t=doc.createElement("div");t.ref=n[x];t.params=j;t.className=j["service"] + " wtWidgets wtWaiting";$wt.before(t,n[x]);$wt._store.push(t);if(c.indexOf((v + j["service"] + a))===-1){c.push(v + j["service"] + a);}}};if(c.length){var p=$wt.urlParams=$wt.getUrlParams(),u=c.join(",")+ "&lang=" + $wt.getDocLang();u +=(p["wtdebug"])? "&wtdebug=true":"&wtdebug=false";$wt.include($wt._path + $wt._js + u,function(){$wt._queue();$wt.addEvent(win,"scroll",$wt._queue);$wt.addEvent(win,"resize",$wt._queue);$wt.addEvent(win,"orientationchange",$wt._queue);},"js");$wt.include($wt._path + $wt._css + u.replace(/\-[a-z]{2}(&)?/ig,"$1"),null,"css");}}if($wt._order.length &&(isIE > 8 || isIE===0)){var temp=[];for(var i in $wt._order){for(var e in $wt._store){if(($wt._store[e].className).indexOf($wt._order[i])!==-1){temp.push($wt._store[e]);}}}for(var e in $wt._store){if(temp.indexOf($wt._store[e])===-1){temp.push($wt._store[e]);}}$wt._store=temp;}},_process:function(){for(var i=0,l=$wt._store.length;i < l;i++){var k=$wt._store[i];if($wt._isVisible(k)){var scrp=k.className.split(" ")[0];k.className=scrp + " wtWidgets wtLoading";win.wtCurrentProcess=k;$wt._store.splice(i,1);$wt._inProgress=true;try{$wt[scrp].run(k);}catch(e){$wt._queue("next");k.innerHTML="<b>" + scrp + ".js</b>:" + e;k.className=scrp + " wtWidgets wtError";}break;}}}};if(!window.wtRunning){$wt.addEvent(win,"load",$wt._collect);window.wtRunning=true;};})(window,document);
